pipeline {
    agent any

    stages {
        stage('code validation') {
            steps {
                echo 'code validation'
		sh 'mvn compile'
            }
        }
        stage('Unit testing') {
            steps {
                echo 'Unit Testing'
		sh 'mvn test'
            }
        }
        stage('sonar analysis') {
            steps {
                echo 'Performing sonar analysis'
		sh 'mvn sonar:sonar -Dsonar.host.url=http://44.202.234.72:9000 -Dsonar.login=42490b7ecc51c5da1430abf6b9de2b22f31cbf39'
            }
	}
        stage('Publish Artifacts') {
            steps {
                echo 'Publishing Artifacts to Nexus'
		sh 'mvn deploy'
            }
	}
        stage('Deploying in tomcat') {
            steps {
                echo 'Deploy in Tomcat'
		sh 'cd /opt/apache-tomcat-7.0.94/webapps/'
		sh 'wget --user admin --password admin123 http://44.202.234.72:8081/nexus/service/local/repositories/releases/content/com/web/cal/WebAppCal/1.4.5/WebAppCal-1.4.5.war'
            }
	}
    }
}
